<!DOCTYPE html>
<html>
<head>
  <title>CAT1 Marks Excel Sheet</title>

  <!-- Handsontable (Excel-like table) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@12.4.0/dist/handsontable.full.min.css">
  <script src="https://cdn.jsdelivr.net/npm/handsontable@12.4.0/dist/handsontable.full.min.js"></script>

  <!-- SheetJS for exporting Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: Arial;
      background: #f2f3f7;
      padding: 20px;
    }

    .container {
      width: 90%;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    button {
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    button:hover {
      background: #0056c1;
    }

    #excelTable {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>ðŸ“˜ CAT1 Excel Sheet (Editable)</h2>

  <button onclick="downloadExcel()">Download Excel</button>

  <!-- Excel-like table -->
  <div id="excelTable"></div>
</div>

<script>
  // Excel-like Sheet Data & Columns
  const container = document.getElementById("excelTable");

  const hot = new Handsontable(container, {
    data: [
      ["", "", "", "", ""],
      ["", "", "", "", ""],
      ["", "", "", "", ""],
      ["", "", "", "", ""],
    ],
    colHeaders: [
      "Registration Number",
      "Student Name",
      "Branch",
      "Subject Name",
      "Marks"
    ],
    rowHeaders: true,
    width: "100%",
    height: 400,
    licenseKey: "non-commercial-and-evaluation" // free license
  });

  // Export to Excel
  function downloadExcel() {
    const sheetData = hot.getData();

    const data = sheetData.map(row => ({
      Registration_Number: row[0],
      Student_Name: row[1],
      Branch: row[2],
      Subject_Name: row[3],
      Marks: row[4]
    }));

    const worksheet = XLSX.utils.json_to_sheet(data);
    const workbook = XLSX.utils.book_new();

    XLSX.utils.book_append_sheet(workbook, worksheet, "CAT1 Marks");

    XLSX.writeFile(workbook, "CAT1_Student_Marks.xlsx");
  }
</script>

</body>
</html>